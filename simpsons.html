<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/>
    <link rel="stylesheet" href="styles.css" />
    <script type="text/javascript" async src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/javascript" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <title>Simpsons Paradox</title>
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    
    <style>
      table {
      width: 80%;
      border-collapse: collapse;
      margin: 20px auto;
      font-family: Arial, sans-serif;
      text-align: center; }

      th, td {
      border: 1px solid #aaa;
      padding: 8px; }

      th {
      background-color: #f2f2f2;
      font-weight: bold;  }

      td {
      background-color: #fff; }

      i {
      font-style: italic; }

      td:first-child {
      font-weight: bold; }
    
      td:nth-child(4),
      td:nth-child(7),
      td:nth-child(10) {
      font-style: italic; }
    </style>
  </head>

  <body>

    <div class="menu-bar">
    <img class="logo" src="images/logo.jpg" style="height:70px; margin: 0px;" alt="logo">
    <ul>
      <li><a href="/homepage.html">Home</a></li>
      <li><a href="/paradoxes.html">Paradoxes<i class="fas fa-caret-down"></i></a>

      <div class="dropdown-menu">
        <ul>
          <li><a href="/simpsons.html">Simpsons Paradox <i class="fas fa-caret-right"></i> </a>
          <div class="dropdown-menu-1">
            <ul>
              <li><a href="/berksons.html">Berksons Paradox</a></li>
            </ul>
          </div>
          </li>

          <li><a href="/parrondos.html">Parrondo's Paradox</a></li>
          <li><a href="/accuracy.html">Accuracy Paradox <i class="fas fa-caret-right"></i> </a>
          <div class="dropdown-menu-2">
            <ul>
              <li><a href="/falsepositive.html">False Positive Paradox</a></li>
            </ul>
          </div>
          </li>

        </ul>
      </div>
      </li>

      <li><a href="/aicases.html">AI Case Study</a></li>
      <li><a href="/flip.html">Study Flashcards</a></li>
      <li><button id="dark-mode-toggle">Dark Mode Toggle</button>
      </li>
    </ul>
    </div>

    <script src="/darkmode.js"></script>
    

    <div class="main"> <!--Main Body-->
    <h1 style="font-size:80px; color:rgb(255, 255, 255); margin:10px; margin-top:90px;">Simpsons Paradox</h1>
    <img src="images/Simpsons.png" style="height:200px; float: right; margin-right: 20px; margin-left: 10px; margin-top: 10px;" alt="Cartoon Homer Simpson next to a scatter graph" title="Source: skewthescript.org">
    <br>

    <h3>The Simpsons Paradox was discovered in 1951 by British Statistician, Edward H. Simpson. The 
      paradox occurs when groups of data show a trend in each group, however that trend is
      reversed when those groups are combined resulting in conflicting interpretations of trends. This 
      paradox is typically used for data interpretation within social sciences and healthcare.
      It can also help in understanding Artificial Intelligence and Machine Learning models.
      The data mining algorithms used in AI and ML identify the correlations in collective data rather 
      than identifying any specific relationships between data groupings. This could cause the Simpsons
      Paradox to occur. 
      <br><br>
      Another similar paradox is the Berksons Paradox, which you can learn more about <b><a href="/berksons.html">here! </a></b>
    </h3>
    <br>

    <div class="contents-box"> <!--Webpage Contents with hyperlinks to place in page-->
      <h3> Contents <br>
        <a href="#examples">1. Examples</a><br>
        <a href="#def">2. Definition</a><br>
        <a href="#occurs">3. Why It Occurs?</a><br>
        <a id="examples"><a href="#real">4. Real World Examples</a></a><br>
        <a href="#practice">5. Practice Questions</a>
      </h3>
    </div>
     
    <br>
    <h3>The best way to learn about Data Science Paradoxes is through examples.
      There are many ways in which we can demonstrate this paradox, we will show a couple of examples below:
    </h3>
    
    <div class="difficulty-tab"> <!--Difficulty Level Tabs-->
      <button class="tablinks" onclick="openLevel(event, 'Beginner')" id="defaultOpen">Beginner</button>
      <button class="tablinks" onclick="openLevel(event, 'Advanced')">Advanced</button>
    </div>
    
    <div id="Beginner" class="tabcontent"> <!--Beginner Tab content-->
      <h3>1. Decision Trees</h3>
      <p>A simple and easy way to demonstrate the Simpsons Paradox is through decision trees.
        If you are unfamiliar with them, a decision tree is a type of flowchart which helps to
        visualise the potential outcomes of a set of decisions. 
        <br><br>
        We will use a dataset from <b><a href="https://medium.com/@Mamdouh.Refaat/data-science-basics-3-decision-trees-and-the-simpsons-paradox-99f26dc049f7" target="_blank">this website.</a></b>
        This dataset contains the records of 900 alien patients
        who caught a viral infection while visiting Earth. When treating the patients with human 
        medication, some aliens recovered but some did not. Depending on the alien's hometown, the 
        Moon or Mars, their survival rates varied. We want to determine if overall the treatment had a
        positive or negative impact on the alien patient's survival rate.
        <br><br>
        In Figure 1, we see the root or beginning node of the decision tree. The red shaded section 
        shows that 50.5% of the alien patients survived the infection.
        <img src="images/figure1.png" style="height:130px;" alt="Root node of a decision tree" title="Source: medium.com">
        <br><br>
        From here we split the root node into two sections depending on whether the patients were 
        treated on earth with human medication or not, to see if any anomalies develop. 
        <br>
        <img src="images/figure2.png" style="height:250px;" alt="Root node of a decision tree split into two more sections" title="Source: medium.com">
        <br>
        In Figure 2, we now have Node 2 which shows untreated patients and Node 3 with treated 
        patients. We can see that the survival rate is higher for treated patients at 55% compared to
        untreated patients at 41.67%. From this we would deduce that for all alien patients it would be
        best to treat them with medication to ensure a higher rate of survival. However, if we split 
        these nodes further based on the alien's hometown would these statistics change?
        <br><br>
        <img src="images/figure3.png" style="height:320px;" alt="Complete decision tree with split sections" title="Source: medium.com">
        <br>
        <a id="def">In Figure 3, </a>we have Node 2 with aliens from Mars and Node 3 with aliens from the Moon. These
        nodes are then further split into aliens who were and were not treated with the corresponding
        survival rates. We see that, no matter what the patient's hometown is, the survival rate of a
        treated patient is actually lower than a non-treated patient.
        <br><br>
        How is this possible? Figure 2 demonstrated that any treated patient has a better survival rate
        than any untreated patient, but Figure 3 demonstrates that when considering an alien's hometown
        they have a better chance of survival if they are not treated. Figure 2 and Figure 3 clearly
        show contradictory conclusions; therefore we have discovered a Simpsons Paradox here.
      </p>
    </div>
    
    <div id="Advanced" class="tabcontent"> <!--Advanced Tab content-->
      <h3>1. 2X2 Contingency Table</h3>
      <p> A more typical way of presenting data involving the Simpsons Paradox is through a contingency table.
        <br><br>
        We will use a dataset from <b><a href="https://link.springer.com/chapter/10.1007/978-3-031-12423-5_25" target="_blank">this website.</a></b>
        This dataset contains information on the success rate of medical treatments on both men and women.  
        <br>

        <table>
          <tr>
              <th rowspan="2"></th> <!-- Empty cell above T and ¬T -->
              <th colspan="3">Population <i>N</i> = 52</th>
              <th colspan="3">Men (M) = 20</th>
              <th colspan="3">Women (F) = 32</th>
          </tr>

          <tr>
              <th>Success (S)</th>
              <th>Failure (¬S)</th>
              <th>Success Rate %</th>
              <th>Success</th>
              <th>Failure</th>
              <th>Success Rate %</th>
              <th>Success</th>
              <th>Failure</th>
              <th>Success Rate %</th>
          </tr>

          <tr>
              <td>T</td>
              <td>20</td>
              <td>20</td>
              <td>50%</td>
              <td>8</td>
              <td>5</td>
              <td>≈61%</td>
              <td>12</td>
              <td>15</td>
              <td>≈44%</td>
          </tr>

          <tr>
              <td>¬T</td>
              <td>6</td>
              <td>6</td>
              <td>50%</td>
              <td>4</td>
              <td>3</td>
              <td>≈57%</td>
              <td>2</td>
              <td>3</td>
              <td>≈40%</td>
          </tr>
          
      </table>
      

        In this table we see that the treatment appears ineffective to the population as a whole, but when
        looking at the gender subgroups the treatment becomes more effective for both groups (Men: 61% vs
        57% and Women: 44% vs 40%). 
        <br><br>
        This can be demonstrated more efficiently through probability theory. We can use the following conditional probabilities:
        <br>
        Let T = Treatment, S = Success, M = Men and F = Women then, 
        <br>
        P(S | T)  =  P(S | ¬T) 
        <br><br>
        However, the probability for men and women is: 
        <br>
        P(S | T,M) > P(S | ¬T,M ) 
        <br>
        P(S | T,F) > P(S | ¬T,F) 
        <br><br>
        Based on these equations, is it better for someone to receive the treatment or not? It is
        difficult to know as overall the treatment is a failure but based on the separate men and
        women populations, the treatment is a success. These contradictory conclusions, given with the
        reversal of results between the different subgroups, demonstrates to us the Simpsons Paradox. 
      </p>
      <script src="/tabContent.js"></script>
    </div>


    <br> 
    <h3><a id="def">2. Definition</a></h3> <!--Definition-->
    <p>The Simpsons Paradox is <b><a href="https://brilliant.org/wiki/simpsons-paradox/" target="_blank">formally defined as follows:</a></b>
    <br><br>

    <p>Consider \( n \) groups of data such that group \( i \) has \( A_i \) attempts and \( 0 \leq a_i \leq A_i \) "successes". 
      Similarly, consider a comparable \( n \) groups of data such that group \( i \) has \( B_i \) attempts and \( 0 \leq b_i \leq B_i \) "successes". 
      Then, <b>Simpson's paradox</b> occurs if</p>
      
      \[
      \frac{a_i}{A_i} \leq \frac{b_i}{B_i} \quad \text{for all } i = 1, 2, \dots, n, \text{ but} 
      \]
      
      \[
      \frac{\sum_{i=1}^{n} a_i}{\sum_{i=1}^{n} A_i} \geq \frac{\sum_{i=1}^{n} b_i}{\sum_{i=1}^{n} B_i}
      \]
    <br>
    <p> Let's go through and clearly explain this definition with an example. 
      <img src="images/sat.png" style="height:180px; float: right; margin-right: 20px; margin-left: 10px;" alt="Table listing maths problems solved" title="Source: brilliant.org">
      You and a friend finish some maths problems for homework. Over the weekend, your friend answers a 
      higher proportion correctly than you on each day. Does this mean your friend has answered a higher
       proportion correctly than you over the whole weekend?
       <br><br>
      We can see the number of problems that you and your friend solved in the table to the right -->
      <br>
      •	On Saturday you solved 7 out of 8 maths problems, but your friend solved 2 out of 2. Even though 
      you had solved more problems, your friend was more accurate as 7/8  <  2/2 . 
      <br>
      •	On Sunday, you solved 1 out of 2 maths problems and your friend solved 5 out of 8 problems. Once 
      again, your friend was more accurate as 1/2  <  5/8 .
      <br><br>
      However, we want to know which person solved more problems accurately over the whole weekend, not
      just on individual days. Overall, you solved 8 out of 10 problems while your friend only solved 7 
      out of 10 problems. So even though your friend solved a higher proportion of problems on each day, you 
      actually won by solving the higher proportion for the entire weekend! A clear example of the 
      Simpsons Paradox in action. 

    </p>
    <br>
    <p>Let's see how this example applies to the definition.
      Here, \( A_i / B_i \) are the number of problems you and your friend attempt on each day, and 
      <a id="occurs">the \( a_i / b_i \) are the number of problems you and your friend solve correctly on each day.</a></p>
      
      \[
      \frac{7}{8} = \frac{a_1}{A_1} < \frac{b_1}{B_1} = \frac{2}{2} \quad \text{and} \quad \frac{1}{2} = \frac{a_2}{A_2} < \frac{b_2}{B_2} = \frac{5}{8},
      \]
      
      \[
      \text{yet} \quad \frac{7+1}{8+2} = \frac{a_1 + a_2}{A_1 + A_2} \geq \frac{b_1 + b_2}{B_1 + B_2} = \frac{2+5}{2+8}.
      \]
      
    </p>


    <br><br>
    <h3>3. Why Does The Paradox Occur?</h3> <!--Why it occurs-->
    <p>There are many different interpretations of how the Simpsons Paradox may occur. One interpretation is that the
      distribution of data is borderline stable, so we cannot truly confirm in which way the data sides
      with. We can scrutinise and regroup data as much as we want but if multiple different conclusions are drawn from different categorisations, then drawing conclusions to gain insight will be difficult. When looking at datasets that exhibit the paradox we see that the groups in question show very different behaviour in terms of distribution, meaning we should check this data for issues.
      <br><br>
      <a id="real">We can detect Simpsons Paradox early on and try to resolve the problem by utilising predictive</a>
      models. We use predictive models to explain how a dependent variable could be associated with the 
      values of a certain independent variable and use these discover issues in specific trends. It is 
      also important to consider what exactly we need to interpret within the data we have, in order to 
      choose the best viewpoint and give a fair representation of the truth.
    </p>


    <br><br>
    <h3>4. Real World Examples</h3> <!--Real world examples-->
    <br>
    <p><b>UC Berkley's Gender Bias - <a href="/simpsons-graph.html" target="_blank">Interactive Chart Here! </a></b>
    <br>
    <img src="images/table.png" style="height:200px; float: right; margin-right: 20px; margin-left: 10px; margin-top: 10px;" alt="Table of UC Berkley graduate admissions" title="Source: discovery.cs.illinois.edu">
      In 1973, UC Berkeley Graduate school admitted around 44% male and 35% female applicants. When this
      was released, the school was worried about facing a gender discrimination lawsuit. So 
      they had statistician, Peter Bickel, investigate their admission data to see if any 
      inconsistencies had occured.
      Peter subdivided the data into different groups to see if any patterns emerged. 
      When separating the data into groups of different majors, a different conclusion was found. He 
      discovered that there was actually a gender bias in favour of women for 4 out of 6 departments and no 
      gender bias occurred in the remaining 2 departments, shown in the table to the right.
  
   
    <br><br>
      This was due to the type of majors that the individuals applied for. Particularly in that semester 
      more women applied for majors with a lower acceptance rate, majors C-F, and men typically applied 
      for majors with a higher acceptance rate, majors A-B. This variable affected the 
      dataset in such a way that it completely reversed the trend which was seen by the dataset as a 
      whole. This highlights that overall percentages can be misleading and its best to 
      consider different viewpoints, and separate datasets into specific subgroups, to get the most 
      accurate information. 
    <br><br>
    <b><a id="practice">COVID 19 Data Analysis</a></b><br>
      Kügelgen recently demonstrated evidence of Simpson's paradox in COVID 19 data analysis. It is
      claimed that Italy's overall case fatality rate was higher than China's in the overall outlook of 
      the dataset. However, when the data was sectioned into age groups it turned out that China had a 
      higher fatality rate than Italy in every age group. This type <br> of discovery is very concerning and 
      highlights the importance of considering the Simpsons Paradox when conducting data analysis. More
      information on this particular case <br> can be found <b><a href="https://ieeexplore.ieee.org/document/9404149" target="_blank">here on this website.</a></b>
    </p>


    <br><br>
    <h3>5. Practice Questions and Advanced Examples</h3> <!--Other Practice Questions-->
    <br>
    <p>
      We will use an example from <b><a href="https://discovery.cs.illinois.edu/learn/Basics-of-Data-Science-with-Python/Simpsons-Paradox/" target="_blank">this website.</a></b>
      <br>
    <img src="images/arrivals.png" style="height:200px;" alt="Table of on time bus arrivals" title="Source: discovery.cs.illinois.edu">
      <br>
      Let's look at this timetable of bus arrivals. How do we know <b>which bus to choose to have the
      best chance of arriving on time?</b> 
      <br><br>
      First, we should look into the total arrival times for both destinations:
      <br>
      <b>Illinois Express</b> - 4615 / 5195 * 100 = 88.8% 
      <br>
      <b>University Transportation </b>- 3003 / 3366 * 100 = 89.2%
      <br><br>
      Looking at these overall results we would assume that choosing the University Transportation would be the better
      option, however let's look at the results individually: 
      <br>
      <b>Illinois Express:</b> Champaign - 3112 / 3609 * 100 = 86%   <br>    Urbana - 1503 / 1586 * 100 = 95% 
      <br>
      <b>University Transportation:</b> Champaign - 764 / 895 * 100 = 85% <br> Urbana - 2239 / 2471 * 100 = 91%
      <br><br>
      If we partition the data in this way, we see that actually the Illinois Express has a better on time average for each destination.
      <br>
    </p>
    </div>

    <script>
      document.getElementById("defaultOpen").click();
    </script>

    <div class="quizcontainer"> <!--Practice Quiz-->
      <h1>Test Your Knowledge!</h1> <br>
      <div id="quiz"></div>
      <div id="result" class="result"></div>
      <button id="submit" class="button">Submit</button>
      <button id="retry" class="button hide">Retry</button>
      <button id="showAnswer" class="button hide">Show Answer</button>
    </div>
    <script src="quiz.js"></script>
    <br><br>

    <div class="main"> <!--Advanced Example-->
      <h3>Would You Like To Try A More Advanced Example?</h3>
      <p>We will use an example from <b><a href="https://link.springer.com/chapter/10.1007/978-3-031-12423-5_25" target="_blank">this website.</a></b>
      <br><br>
      I have four boxes, each containing a number of red and blue marbles.</p>
      <img src="images/marbs.png" style="height:200px;" alt="Table containing how many marbles of each colour" title="Source: link.springer.com">
      <p> If the probability of randomly selecting a red marble from Box A is a, and the probability of
        randomly selecting a red marble from Box B is b, then a is more than b.
        <br><br>
        Suppose we group all the marbles in Box A and Box C into another Box AC. We also group all
        the marbles in Box B and Box D into another Box BD. Now, there is a higher probability of 
        randomly selecting a red marble from Box AC than from Box BD.
        <br>
        <b>What is the smallest and the largest possible values of y, so that the above criteria is satisfied?</b> (Please type in a valid number)
      </p>

      <br>
      <p>Smallest Value:</p> <!--Text Input Box (Small Value) JAVASCRIPT-->
      <div class="input-container">
        <input type="number" id="userInput">
        <button onclick="checkAns()">Submit</button>
        <p id="message"></p>
      </div>

      <script>
        const correctAnswer = 6; // Set the correct answer here
        function checkAns() {
          let userGuess = document.getElementById("userInput").value;
          let message = document.getElementById("message");

          if (userGuess == correctAnswer) {
            message.textContent = "Correct! Well done!";
            message.style.color = "green"; } 
          else {
            message.textContent = "Incorrect, try again!";
            message.style.color = "red"; } 
        }
      </script>

      <br>
      <p>Largest Value:</p> <!--Text Input Box (Largest Value) JAVASCRIPT-->
      <div class="input-container">
        <input type="number" id="userInput1">
        <button onclick="checkA()">Submit</button>
        <p id="message1"></p>
      </div>

      <script>
      const correctAns = 26; // Set the correct answer here
      function checkA() {
        let userG = document.getElementById("userInput1").value;
        let mess = document.getElementById("message1");

        if (userG == correctAns) {
          mess.textContent = "Correct! Well done!";
          mess.style.color = "green"; } 
        else {
          mess.textContent = "Incorrect, try again!";
          mess.style.color = "red"; }
        } 
      </script>

      <br> <!--Hint Button JAVASCRIPT-->
      <button type="button" class="collapsible">Need a hint?</button>
      <div class="content">
      <p><br>
        <b>Step 1: Define the probabilities for boxes A and B</b>
        <br>
        The probability of picking a red marble from a box is 
        <br>
        no. of red marbles / no. of total marbles
        <br><br>

        <b>Step 2: Define the probabilities for boxes AC and BD</b>
        <br>
        Form Box AC by combining the probabilities of Box A and Box C, and Box BD by combining the probabilities of Box B and Box D.
        <br><br>
        For Box AC this would be: <br> no. of red marbles in A + no. of red marbles in C / <br> total no. of marbles in A + total no. of marbles in C
        <br><br>

        <b>Step 3: Solve for y</b>
        <br>
        Find the smallest and largest values of y that satisfy the probability of picking a red marble.
        <br><br>
      </p>
      </div>

      <script>
        var coll = document.getElementsByClassName("collapsible");
        var i;

        for (i = 0; i < coll.length; i++) {
          coll[i].addEventListener("click", function() {
          this.classList.toggle("active");
          var content = this.nextElementSibling;
        if (content.style.display === "block") {
          content.style.display = "none";} 
        else {
          content.style.display = "block";}
        });
        }
      </script>

      <br><br><br>
    </div>
  </body>
</html> 